
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∞–º–∏</title>
	<link href="css.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
</head>
<body>

	<div id="app" v-cloak> 
		<div class="toolbar container">
			<a href=""
				class="button is-primary is-medium" 
				v-on:click.prevent="showList()"
				v-bind:class="{active: screen === 'list'}"
				>–ó–∞–¥–∞—á–∏</a>
			<a href="" 
				class="button is-primary is-medium" 
				v-on:click.prevent="showForm($event)"
				v-bind:class="{active: screen === 'form'}"
				v-if="mode === 'creating'"
				>–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</a>
			<a href="" 
				class="button is-primary is-medium" 
				v-on:click.prevent="editItem(task)"
				v-bind:class="{active: screen === 'form'}"
				v-if="mode === 'editing'"
				>–ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É</a>
		</div>

		<div class="container box" v-if="screen === 'form'">
			
			<form>
				<input class="item input is-success is-normal is-rounded" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" v-model="task.name">
				<br>

				<input class="item input is-success is-normal is-rounded" type="text" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" v-model="task.description">
				<span v-if="errors.description" class="notification is-danger is-light"> {{errors.description}} </span>
				<br>

				<span class="itemtag tag is-primary is-medium is-rounded is-light">–¢–∏–ø</span>
				<br>
				<div class="item select is-success is-normal is-rounded"><select v-model="task.type" placeholder="xt">
					<option v-for="(label, key) in types" v-bind:value="key"> {{label}} </option>
				</select>
				</div>
				<br>
				<span class="itemtag tag is-primary is-medium is-rounded is-light">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</span>
				<input class="item" type="checkbox" v-model="task.prio"> {{ task.prio | prio }}
				<br>
				<br>
				<button type="button" class="button is-success is-rounded" v-on:click="addItem()" v-if="mode === 'creating'">–î–æ–±–∞–≤–∏—Ç—å</button>
				<button type="button" class="button is-success is-rounded" v-on:click="saveItem()" v-if="mode === 'editing'">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
				<br>
				<br>
				<br>
			</form>
			<span v-if="errors.name" class="notification is-danger is-light"></button> {{errors.name}}</span>
			<br>

		</div>

		<div class="container" v-if="screen === 'list'">
			<table class="table is-striped is-fullwidth">
				<thead>
					<tr>
						<th>–ù–æ–º–µ—Ä</th>
						<th>–í—ã–ø–æ–ª–Ω–µ–Ω–æ</th>
						<th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
						<th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
						<th>–¢–∏–ø</th>
						<th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
						<th>–î–µ–π—Å—Ç–≤–∏—è</th>
					</tr>
				</thead>
				<tbody>
					<tr v-for="(item, index) in items">
						<td> {{ index + 1 }} </td>
						<td>
							<span class="done" v-on:click="makeDone(item)">{{ item.done ? '‚úÖ' : '‚¨ú'}}</span>
						</td>
						<td> {{ item.prio | prio }} </td>
						<td> {{ item.name }} </td>
						<td>
							<span v-for="(name, type) in types" v-text="name" v-if="item.type === type"></span>
						</td>
						<td> {{item.description}}</td>
						<td>
							<button class="button is-info is-light" v-on:click="editItem(item)">
								<span class="icon is-small">
									<i class="fas fa-edit"></i>
							    </span>
							    <span>–ò–∑–º–µ–Ω–∏—Ç—å</span>
							</button>

							<button class="button is-danger is-outlined is-light" v-on:click="delItem(index)">
								<span>–£–¥–∞–ª–∏—Ç—å</span>
							    <span class="icon is-small">
							    	<i class="fas fa-times"></i>
							    </span>
							</button>
						</td>
					</tr>
					
				</tbody>
			</table>
			<div v-else>
				<em> no items!</em>
			</div>
		</div>
	</div>


	<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>

	<script>
		
		new Vue({
			el: "#app",
			data: {
				types: {
					call: '–ó–≤–æ–Ω–æ–∫',
					meeting: '–í—Å—Ç—Ä–µ—á–∞',
					task: '–ó–∞–¥–∞–Ω–∏–µ'
				},
				screen: 'list',
				mode: 'creating',
				editingItem: {},
				errors: {},
				task: {
					name:'',
					description:'',
					type: '',
					prio: false,
					done: false,
				},
				items: [
					{
						name: '–ó–∞–º–µ—Ç–∫–∞ 1',
						description: '–û–ø–∏—Å–∞–Ω–∏–µ',
						type: "",
						prio: true,
						done: false,
					},
					{
						name: '–ó–∞–º–µ—Ç–∫–∞ 2',
						description: '–û–ø–∏—Å–∞–Ω–∏–µ',
						type: "",
						prio: false,
						done: false,
					}
				]
			},
			filters: {
				prio: function(value)
				{
					return value ? 'üö©' : '';
				}
			},
			watch: {
				screen: function() {
					console.log(this.screen);
				}
			},
			methods: {
				showForm: function(e) {
					this.screen = 'form';
					this.mode = 'creating';
					this.task = {
							name: '',
							description: '',
							type: '',
							prio: false,
							done: false,
						};
				},
				showList: function(e) {
					this.screen = 'list';
					this.mode = 'creating';
				},
				updateList: function() {
					if (this.task.name){
						Object.assign(this.editingItem, this.task);
						this.editingItem = {};
						this.showList();
					}
				},
				addItem: function() {
					this.errors =  {};
					if (!this.task.name)
					{
						this.errors.name = "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é";
						return
					}
					this.items.push(this.task);
					this.task = {
						name: '',
						description: '',
						type: '',
						prio: false,
						done: false,
					};
					this.showList();
					
				},
				saveItem: function() {
					this.errors = {};
					if (!this.task.name)
					{
						this.errors.name = "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—é";
						return
					}
					Object.assign(this.editingItem, this.task);
					this.editingItem = {};
					this.showList();
					
				},
				makeDone: function(item) {
					item.done = !item.done;
				},
				editItem: function(item) {
					this.showForm();
					this.editingItem = item;
					this.task = Object.assign({}, item);
					this.mode = 'editing';
					
				},
				delItem: function(index) {
					this.items.splice(index, 1);
				}
			}

		});
			
	</script>
</body>
<footer class="footer">
</html>
